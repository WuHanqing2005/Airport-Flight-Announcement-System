软件名称：航班广播语音系统
版本号：2024.11.11（Debug中，非正式版本）
软件版权归属：吴瀚庆
未经允许，禁止盗用，侵权必究

有意请联系软件作者 吴瀚庆
微信：whq20050121
手机：19528873640
邮箱：m19528873640@outlook.com
欢迎提出宝贵意见，感谢支持！

备注：
如何将程序连同所需要的第三方库一同打包的问题仍未解决……

更新日志：
2024.04.02	程序诞生，废弃之前用对接谷歌TTS网络接口进行合成的方式，改用拼接wav格式语音包合成语音
			并且用tkinter生成了可视化界面，即使这个界面还很简陋
2024.04.04	修复了一些bug
2024.04.05	修改了一下值机柜台的合成逻辑，之前只可以生成值机柜台为“XX-XX”格式
			现在可以任意多个值机柜台，以“-”分割即可，例如“A01-A03-A04”
			利用try-except语句以及tkinter，实现了可视化报错窗口，便于用户更加方便直观看到报错信息
2024.04.06	简单增加了一下英文值机广播的前两句，等待英文语音包的完善
			增加了“添加航班”的报错，对输入信息的检查，例如检查输入的新航班号是否为纯大写字母与数字组合，检查空值
			用reecho.ai完善了一下语音包，中英文的航空公司名称以及英语到达广播的句型语音片段
2024.04.07	完善了一下英文句型语音包，并且加入了对英文城市语音包文件存在性的检验
			增加了日语值机广播句型
2024.04.08	增加了“登机口号码”、“行李提取转盘”两栏，修改了添加航班时的逻辑，不再只是可以用下拉列表选择城市，增加了手动输入的功能
			增加了一些上海各区的中英日语音库
2024.04.10	完善了一下判断英文日文城市及航空公司语音包的逻辑，并且完善了一些注释，修改了一下示例航班
2024.04.11	删除了没用的部分代码，生成航班广播时生成对应的announcement文本信息
2024.04.17	增加了选择播放广播种类的功能框架，例如供用户选择“值机广播”、“到达广播”，代码仍不完善
2024.04.26	增加了语言种类一栏，供用户选择的语言种类有：“中英”，“中英日”，“中英韩”
			完善了一下新增航班信息时的检查逻辑，检查是否为空值，检查是否为纯大写字母和数字的组合，检查地名是否在中文城市语音包中等
			完善了一下注释，调整了一下生成name列表以及生成音频播放音频的逻辑
			在name列表全部完成后，跳出if循环，先检索name列表中的语音包路径都是否存在，然后再单独进行生成音频
			修改了输出的wav文件的储存路径，改为生成在目录下的“output”文件夹中
			并且生成的wav文件的文件名为“航班号+类型”的格式，例如：“CZ628-Arrival.wav”
			新增了一条示例航班“MU1278”，现在一共有四个示例航班，“MU2546”、“MU1278”、“CA630”、“CZ628”
			启动软件时默认显示这四个示例航班
2024.04.27	迁移到了Visual Studio上进行开发，并将储存航班信息的二维数组data，存储在data.xlsx文件中
			通过data.xlsx文件进行航班信息的存储与读取，软件运行时，通过读取xlsx表格中的内容获取航班信息并显示
			然后在软件中对航班信息进行增删后，可以保存到data.xlsx文件中，以便下次打开软件后可以继续读取原来的航班信息
			但是修改后，出现了一个小bug，就是偶尔在按“Save Data”按键保存航班信息后，刷新出来的登机口和行李提取转盘的两列可能为浮点数类型
			暂时还没修复这个bug，这个bug也并不影响程序的运行，但是如果需要用到登机口和行李提取转盘号码，请务必声明为int整数类型
			修改了部分注释，修改了主程序的标题为“Automatic Flight Announcement System”
2024.04.28	为每个功能函数都添加了try...except语句，完善了报错提示，便于分析程序出错原因
			将项目上传到了个人的github上，但是并没有开源，由于语音包版权受限
			为了系统兼容文件路径，将文件路径中的双反斜杠\\，改为用os.path.join()函数生成文件路径
			将播放航班广播的按钮，改成了两个，一个是“Play new announcement”，还有一个是“Play old announcement”
			这样可以节省时间，避免重复合成航班广播
			同时，为了防止播放航班广播冲突，或者想立即暂停航班广播播放，添加了“停止所有进程”的按钮
			可以停止所有正在播放或者正在合成的进程
2024.04.29	将登录界面的文字改为浅蓝色底黑色字，更换了新的登录界面的背景图片
			填补上了带有经停地的到达广播的代码部分
			增加了，写入错误日志的功能，方便后期维护
			增加了进度条显示，在合成航班广播时候，可以看到合成进度以及正在合成的语音包
			优化了一下“Stop all process”按钮的逻辑，但还是有可能报错：mixer not initialized，但是并不会影响程序
2024.04.30	删除了“航空公司”一列，改为通过获取航班号的前两位，也就是航空公司的二字代码，来识别航空公司
			支持了多个航班号，也就是“共享航班”，只需要在输入航班号时用空格将不同航班号分隔开即可
			添加了，抵达广播的英文部分，添加了一条示例航班，“CZ627 CA5022 MU656”
2024.05.01	为了适配不同电脑系统，适配编码格式，改为全英文界面，语音包文件正在逐步改为全英文名称
			调整了主程序界面的部分列宽
2024.05.02	将使用的python解释器版本从3.12降为3.11.5，试图解决系统兼容适配问题，但是以失败告终
			但是为了python解释器的适配和稳定，决定继续采用3.11.5版本的python解释器
2024.05.05	经过不断查找在其他电脑上无法运行的原因，一直报错“WinError2：找不到指定文件”，已经找到了原因
			因为material文件夹下的语音包文件有单声道也有双声道
			现在将material文件夹下所有语音包文件都改为了双声道，已经成功在虚拟机上运行，但还需要在其他电脑上真正运行一下
			修改了一下refresh_table()函数的逻辑，使用户点击“Read Info”读取信息刷新表格时
			将登机口号码和行李提取处号码，转换为整数类型再转换成字符串类型
			新增了一个示例航班“MU9192”
			将英文字母的语音包换为了IED英语的字母语音包，而不是采用IED中文的字母语音包
			修改了search_data中play_announcement的逻辑，如果在生成航班广播时被中断，则不再提示mixer初始化的相关pygame错误消息
2024.05.06	添加了将“material”文件夹下所有子文件夹中wav音频文件转换成双声道的功能，默认在软件登录后运行，与读取航班数据一并进行
2024.05.20	增加了一些语音包
2024.06.14	登录界面增加了退出按钮，用户可以选择登录或直接退出
			增加了下方工作栏，一蓝一粉，更加美观
2024.10.27	修改了“Save Info”按钮逻辑，将代码中的lambda传参删除，修改代码行如下
			save_button = tk.Button(toolbar_2, text="Save Info", command=write_xlsx(data, filename))
			解决了新增的航班信息，按下保存之后，新增航班会保存不进去的问题
			将部分语音包，用GPT-Sovits重新进行了合成
2024.11.11	添加了四栏：
			备降机场“Divert”栏、计划抵达时间“Scheduled Arrival Time”栏、预计抵达时间“Estimated Arrival Time”栏，延误原因“Delay Reason”栏
			同时修改了data.xlsx，以及软件主界面显示航班信息的相关代码，改为12列数据显示，并调整了一下每列的列宽，调整了跳出窗口居中显示的相关代码
			将储存延误原因的语音包文件夹“delay_reason_cn”，直接放在material文件夹下，不再放在material/template_cn文件夹中
			同时因为增加四列航班有关信息，造成的改动，如新增航班的查重逻辑，刷新表格，写入表格的逻辑，均进行了修改
			基本结构已经修改完毕，新的航班句型功能还没有加入
			仍在Debug中，并非正式版本！


软件简单说明：
（为初始版本的简单说明，与现版本可能略有偏差）
航班信息储存在了data文件夹中的data.xlsx文件中，通过读取和修改data.xlsx文件，通过data二维数组传入参数，实现航班信息实时存储删改。
也就是说，增加或者删除航班信息时，会直接将改动存储到data.xlsx表格中，以便下次运行软件时直接读取。
默认的data.xlsx文件，有四个示例航班：“MU2546”、“MU1278”、“CA630”、“CZ628”。请根据需要自行删改
首先，读取cityname_cn目录中的所有城市文件名，读取airlines_cn目录中的所有航空公司文件名，作为下拉列表。
主程序为一个欢迎窗口显示登录界面，然后进入主界面，用可视化界面生成表格显示航班信息，功能按钮显示在下方。
定义按钮：左侧：添加航班按钮、删除航班按钮、播放广播按钮；右侧：清除按钮，读取信息按钮，保存信息按钮。
通过以上按钮，实现程序功能，如果在任何步骤中出现问题，出现报错，请联系软件作者，微信号：whq20050121。

软件使用注意：
1.请勿擅自动软件目录下的任何文件夹！！！
2.在生成语音包时，可能会不断弹出黑色窗口，大概半分钟到一分钟，这是在合成语音广播的过程，请耐心等待！
3.合成好的广播文件，会生成在output文件夹中，名称格式为：“航班号-广播类型.wav”，例如：“CA630-Check-in.wav”。
4.如果刚进入软件界面时，登机口号码和行李提取处号码显示为一堆小数，则请按一下“Read Info”按钮，重新读取数据，从而转化成整数。

航班信息参数：
0.Flight Number
1.Departure
2.Stopover
3.Destination
4.Divert
5.Check-in Counter
6.Boarding Gate
7.Baggage Claim
8.Scheduled Arrival Time
9.Estimated Arrival Time
10.Delay Reason
11.Language

航班广播文本：
	1.值机广播（Check_in）
		cn：
		乘坐 中国南方航空公司 CZ627 次航班，从 沈阳 前往 东京 的旅客请注意。
		您乘坐的航班现在开始办理乘机手续，请前往 F01 至 F06 号柜台办理，谢谢！
		en：
		May I have your attention please!
		We are now ready for check-in for, China Southern Airlines, Flight CZ627,
		From Shenyang to Tokyo Narita, at check-in counter number F01 to F06. Thank you!
		ja：
		ご案内申し上げます，ただいまから チェックイン(Check-in) を開始いたします。
		中国南方航空627便，審陽 発 東京成田 ゆきにご搭乗の客様は，
		チェックイン カウンター (Check-in Counter) 番号 F01 から F06，までお進みください。
	2.到达广播（Arrival）
		cn：
		迎接旅客的各位请注意，从 东京 飞来的 中国南方航空公司 CZ627 次航班，已经到达本站，
		请您在到达大厅等候接待，谢谢！
		en：
		May I have your attention please. China Southern Airlines,
		Flight CZ627 with service from Tokyo Narita has arrived. Thank you!
	3.行李提取广播（Baggage_Claim）
		cn：
		乘坐 上海航空公司 FM9499 次航班，
		从 郑州 到达本站的旅客请注意。
		请前往 8 号行李转盘提取您的行李，谢谢！
		en：
		May I have your attention please.
		Arriving passengers on Shanghai Airlines.
		Flight FM9499 with service from Zhengzhou.
		Your baggage will be available at baggage claim 8, thank you.
	4.出发延误已定广播（Departure_Delay_Determined)
	5.出发延误未定广播（Departure_Delay_Undetermined)
	6.到达延误已定广播（Arrival_Delay_Determined）
	7.到达延误未定广播（Arrival_Delay_Undetermined）

航班广播模板片段wav文件说明：（2024.07.11新增）

template_cn
	1.wav	乘坐
	2.wav	次航班，从
	3.wav	经由
	4.wav	前往
	5.wav	的旅客请注意，您乘坐的航班现在开始办理乘机手续，请前往
	6.wav	至
	7.wav	号柜台办理，谢谢
	8.wav	迎接旅客的各位请注意
	9.wav	从
	10.wav	飞来的
	11.wav	次航班已经到达本站，请您在到达大厅等候接待，谢谢
	12.wav	到达本站的旅客请注意，请前往
	13.wav	号行李转盘提取您的行李，谢谢
	14.wav	的旅客请注意，我们很抱歉地通知各位

template_en
	1.wav	May I have your attention please
	2.wav	We are now ready for check-in for
	3.wav	flight
	4.wav	from
	5.wav	to
	6.wav	with continuing service to
	7.wav	at check-in counter number
	8.wav	Thank you
	9.wav	with service from
	10.wav	has arrived
	11.wav	and
	12.wav	Arriving passengers on
	13.wav	Your baggage will be available at baggage claim

template_ja
	1.wav	ご案内申し上げます
	2.wav	ただいまから チェックイン(Check-in) を開始いたします
	3.wav	便
	4.wav	発
	5.wav	経由
	6.wav	ゆきにご搭乗の客様は
	7.wav	チェックイン カウンター (Check-in Counter) 番号
	8.wav	までお進みください
	9.wav	から



如何更新语音包：
软件目录中各个文件夹包含内容如下：
文件夹“data”下存放了			data.xlsx文件，用于储存航班信息
文件夹“data_copy”下存放了		data.xlsx的备份文件，误删data文件夹中的data.xlsx文件时，可以复制过去
文件夹“material”下存放了所有语音包文件，其中：
	文件夹“airlines_cn”下存放了，航空公司的中文语音包
	文件夹“alnum_cn”下存放了，数字和字母的中文语音包
	文件夹“cityname_cn”下存放了，城市名称的中文语音包
	……（以此类推，在此不再赘述）
文件夹“output”				用来存储合成好的广播音频文件

总而言之，语音包都存储在“material”文件夹中，添加或者更改语音包时，请务必联系软件作者，防止程序报错！
请勿随意删除或者改动或者重命名软件内的任何文件夹或者文件！如果由于擅自对软件进行改动造成的软件出错，概不负责！

注意：语音包只支持wav文件！！！wav文件务必是双声道音频！！！新增语音包时务必检查！！！

如何获得语音片段：
联系软件作者，吴瀚庆，微信号：whq20050121
联系软件作者，合成新的语音片段，然后直接将语音片段复制粘贴到指定文件夹内即可


关于软件说明，就到此为止啦~
欢迎提出宝贵意见，感谢支持！


