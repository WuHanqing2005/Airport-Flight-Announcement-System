# Airport-Flight-Announcement-System
Airport Flight Announcement System.

## 基本信息

- **软件名称**：航班广播语音系统
- **版本号**：2025.10.22
- **版权归属**：吴瀚庆
- **许可声明**：未经允许，禁止盗用，侵权必究

## 联系方式

- **微信**：Daniel_Qinghan
- **手机**：+86-195-2887-3640; +82-010-5861-5296
- **邮箱**：wuhanqing2005@gmail.com

欢迎提出宝贵意见，感谢支持！

> **备注**：无

## 更新日志

### 2024.04.02
- 程序诞生，废弃之前用对接谷歌TTS网络接口进行合成的方式
- 改用拼接wav格式语音包合成语音
- 用tkinter生成了可视化界面

### 2024.04.04
- 修复了一些bug

### 2024.04.05
- 修改值机柜台的合成逻辑，支持任意多个值机柜台（以"-"分割）
- 实现可视化报错窗口，便于用户直观看到报错信息

### 2024.04.06
- 增加英文值机广播的前两句
- 增加输入信息检查功能（检查航班号格式、空值等）
- 用reecho.ai完善语音包

### 2024.04.07
- 完善英文句型语音包
- 加入英文城市语音包文件存在性检验
- 增加日语值机广播句型

### 2024.04.08
- 增加"登机口号码"、"行李提取转盘"两栏
- 增加手动输入城市功能
- 增加上海各区的中英日语音库

### 2024.04.10
- 完善判断逻辑和注释
- 修改示例航班

### 2024.04.11
- 删除无用代码
- 生成航班广播时同时生成对应的announcement文本信息

### 2024.04.17
- 增加选择广播种类功能框架（值机广播、到达广播等）

### 2024.04.26
- 增加语言种类选择（中英、中英日、中英韩）
- 完善新增航班信息的检查逻辑
- 修改输出wav文件的储存路径和命名格式
- 新增示例航班"MU1278"

### 2024.04.27
- 迁移到Visual Studio开发
- 将航班信息存储在data.xlsx文件中
- 实现数据的持久化存储

### 2024.04.28
- 为每个功能函数添加try...except语句
- 完善报错提示机制
- 使用os.path.join()生成文件路径，提高系统兼容性
- 增加"停止所有进程"按钮

### 2024.04.29
- 美化登录界面
- 完善带有经停地的到达广播代码
- 增加错误日志功能
- 增加进度条显示

### 2024.04.30
- 支持共享航班（多个航班号用空格分隔）
- 添加抵达广播的英文部分

### 2024.05.01
- 改为全英文界面
- 语音包文件逐步改为全英文名称

### 2024.05.02
- 调整python解释器版本兼容性

### 2024.05.05
- 解决"WinError2：找不到指定文件"问题
- 将所有语音包文件改为双声道
- 完善refresh_table()函数逻辑

### 2024.05.06
- 添加自动转换语音包为双声道的功能

### 2024.05.20
- 增加语音包资源

### 2024.06.14
- 登录界面增加退出按钮
- 美化工作栏界面

### 2024.10.27
- 修复保存航班信息的问题
- 使用GPT-Sovits重新合成部分语音包

### 2024.11.11
- 新增四栏：备降机场、计划抵达时间、预计抵达时间、延误原因
- 调整界面显示为12列数据
- 仍在Debug中，非正式版本

### 2025.10.01
- 添加了右键菜单，用户也可以通过右键选中航班信息，从而选择播放广播或者删除修改等操作。
- 修改了save_button的逻辑，添加了执行Save Info操作后的提示窗口，提醒用户已成功保存航班信息。

## 软件说明

航班信息储存在`data/data.xlsx`文件中，通过读取和修改该文件实现航班信息的实时存储和删改。

### 默认数据
默认包含四个示例航班："MU2546"、"MU1278"、"CA630"、"CZ628"

### 界面功能
- **左侧功能按钮**：添加航班、删除航班、播放广播
- **右侧功能按钮**：清除、读取信息、保存信息

## 使用注意事项

1. **请勿擅自修改软件目录下的任何文件夹！**
2. 生成语音包时可能会弹出黑色窗口，请耐心等待（约半分钟到一分钟）
3. 合成好的广播文件保存在`output`文件夹中，命名格式为："航班号-广播类型.wav"
4. 如果登机口号码和行李提取处号码显示异常，请点击"Read Info"按钮重新读取数据

## 航班信息参数

| 序号 | 参数名称 | 说明 |
|------|----------|------|
| 0 | Flight Number | 航班号 |
| 1 | Departure | 出发地 |
| 2 | Stopover | 经停地 |
| 3 | Destination | 目的地 |
| 4 | Divert | 备降机场 |
| 5 | Check-in Counter | 值机柜台 |
| 6 | Boarding Gate | 登机口号码 |
| 7 | Baggage Claim | 行李提取处 |
| 8 | Scheduled Arrival Time | 计划抵达时间 |
| 9 | Estimated Arrival Time | 预计抵达时间 |
| 10 | Delay Reason | 延误原因 |
| 11 | Language | 语言类型 |

## 航班广播文本示例

### 1. 值机广播（Check_in）
**中文**：
乘坐 中国南方航空公司 CZ627 次航班，从 沈阳 前往 东京 的旅客请注意。您乘坐的航班现在开始办理乘机手续，请前往 F01 至 F06 号柜台办理，谢谢！

**英文**：
May I have your attention please! We are now ready for check-in for, China Southern Airlines, Flight CZ627, From Shenyang to Tokyo Narita, at check-in counter number F01 to F06. Thank you!

**日语**：
ご案内申し上げます，ただいまから チェックイン(Check-in) を開始いたします。中国南方航空627便，審陽 発 東京成田 ゆきにご搭乗の客様は，チェックイン カウンター (Check-in Counter) 番号 F01 から F06，までお進みください。

### 2. 到达广播（Arrival）
**中文**：
迎接旅客的各位请注意，从 东京 飞来的 中国南方航空公司 CZ627 次航班，已经到达本站，请您在到达大厅等候接待，谢谢！

**英文**：
May I have your attention please. China Southern Airlines, Flight CZ627 with service from Tokyo Narita has arrived. Thank you!

### 3. 行李提取广播（Baggage_Claim）
**中文**：
乘坐 上海航空公司 FM9499 次航班，从 郑州 到达本站的旅客请注意。请前往 8 号行李转盘提取您的行李，谢谢！

**英文**：
May I have your attention please. Arriving passengers on Shanghai Airlines. Flight FM9499 with service from Zhengzhou. Your baggage will be available at baggage claim 8, thank you.

### 其他广播类型
- 4. 出发延误已定广播（Departure_Delay_Determined)
- 5. 出发延误未定广播（Departure_Delay_Undetermined)
- 6. 到达延误已定广播（Arrival_Delay_Determined）
- 7. 到达延误未定广播（Arrival_Delay_Undetermined）

## 目录结构
项目根目录/

├── data/ # 航班数据存储

│ └── data.xlsx # 航班信息文件

├── data_copy/ # 数据备份

├── material/ # 语音包资源

│ ├── airlines_cn/ # 航空公司中文语音包

│ ├── alnum_cn/ # 数字字母中文语音包

│ ├── cityname_cn/ # 城市名称中文语音包

│ ├── template_cn/ # 中文模板语音

│ ├── template_en/ # 英文模板语音

│ ├── template_ja/ # 日文模板语音

│ └── delay_reason_cn/ # 延误原因语音包

└── output/ # 输出目录（生成的广播文件）

## 语音包更新说明

- 语音包只支持wav格式文件
- wav文件必须是双声道音频
- 新增语音包时请务必联系软件作者，防止程序报错
- 请勿随意删除、改动或重命名软件内的任何文件夹或文件

## 获取语音片段

如需获取新的语音片段，请联系软件作者：
- **微信**：Daniel_Qinghan
- 我们将为您合成新的语音片段并指导如何添加到指定文件夹

---

感谢使用航班广播语音系统！欢迎提出宝贵意见！
